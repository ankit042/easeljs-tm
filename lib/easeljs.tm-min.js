(function(){var t,n,e,i={}.hasOwnProperty,r=function(t,n){function e(){this.constructor=t}for(var r in n)i.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};n=function(t,e){var i,r,l;l=[];for(i in e)r=e[i],Object.prototype.hasOwnProperty.call(e,i)&&("[object Object]"===Object.prototype.toString.call(r)?(t[i]={},l.push(n(t[i],r))):l.push(t[i]=r));return l},"undefined"!=typeof window&&null!==window&&(null==window.createjs&&(window.createjs={}),t=window.createjs),null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)&&(null==(e=module.exports).createjs&&(e.createjs={}),t=module.exports.createjs),n(t,{tm:{}}),t.tm.Bitmap=function(n){function e(n){return n instanceof t.tm.BitmapData?this.initialize(n.canvas):(this.initialize(n),void 0)}return r(e,n),e}(t.Bitmap),t.tm.BitmapData=function(){function n(t,n){this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=n,this.ctx=this.canvas.getContext("2d")}var e,i,r,l;return r=t.Stage,e=t.Container,i=t.Shape,l=function(t){return"[object Number]"===Object.prototype.toString.call(t)},n.CHANNEL_RED=parseInt("1000",2),n.CHANNEL_GREEN=parseInt("0100",2),n.CHANNEL_BLUE=parseInt("0010",2),n.CHANNEL_ALPHA=parseInt("0001",2),n.prototype.noise=function(t,n,e,i,r,l,a,s,o){return null==e&&(e=88675123),null==i&&(i=!1),null==r&&(r=0),null==l&&(l=255),null==a&&(a=14),null==s&&(s=!1),null==o&&(o={x:0,y:0}),this._updatePixels(this._noise(t,n,e,i,r,l,a,s,o)),this},n.prototype._noise=function(e,i,r,l,a,s,o,u,h){var c,p,f,d,y,m,w,N,v,_,g,E,x,A,L,H,C,b,j,B,D,I,X,P;for(null==r&&(r=88675123),null==l&&(l=!1),null==a&&(a=0),null==s&&(s=255),null==o&&(o=14),null==u&&(u=!1),X=null!=h?h:{x:0,y:0},j=X.x,D=X.y,b=this.canvas.width,_=this.canvas.height,B=new t.tm.Xor128(r),A=Math.min(a,s),C=Math.abs(a-s),H=(o&n.CHANNEL_RED)/n.CHANNEL_RED,v=(o&n.CHANNEL_GREEN)/n.CHANNEL_GREEN,d=(o&n.CHANNEL_BLUE)/n.CHANNEL_BLUE,p=(o&n.CHANNEL_ALPHA)/n.CHANNEL_ALPHA,y=[],g=0,x=I=0,P=b*_;P>I;x=I+=1)m=j+x%b>>0,w=D+x/b>>0,m=m/e>>0,w=w/i>>0,l&&(m%=b,w%=_),E=w*b+m<<2,L=A+B.at(E++)%C,u?(N=f=L,E+=2):(N=A+B.at(E++)%C,f=A+B.at(E++)%C),c=A+B.at(E++)%C,y[g++]=L*H,y[g++]=N*v,y[g++]=f*d,y[g++]=255-c*p;return y},n.prototype.perlinNoise=function(t,n,e,i,r,l,a,s,o){return null==e&&(e=6),null==i&&(i=88675123),null==r&&(r=!1),null==l&&(l=.5),null==a&&(a=7),null==s&&(s=!1),null==o&&(o=[]),this._updatePixels(this._perlinNoise(t,n,e,i,r,l,a,s,o)),this},n.prototype._perlinNoise=function(t,n,e,i,r,l,a,s,o){var u,h,c,p,f,d,y,m,w,N,v,_,g,E,x,A,L,H,C,b,j,B,D,I,X,P;for(null==e&&(e=6),null==i&&(i=88675123),null==r&&(r=!1),null==l&&(l=.5),null==a&&(a=7),null==s&&(s=!1),null==o&&(o=[]),x=this.canvas.width,d=this.canvas.height,N=[],p=0,y=A=0;e>A;y=A+=1)f=1<<y,u=Math.pow(l,y),N[y]={offset:o[y],frequency:f,amplitude:u,baseX:t/f,baseY:n/f},p+=u;for(p=1/p,L=0,b=N.length;b>L;L++)w=N[L],w.amplitude*=p;for(y=H=0,j=N.length;j>H;y=++H)w=N[y],v=w.offset,h=w.baseX,c=w.baseY,g=this._noise(h,c,i,r,0,255,a,s,v),w.pixels=g;for(E=[],C=0,B=N.length;B>C;C++)for(w=N[C],g=w.pixels,u=w.amplitude,m=X=0,D=g.length;D>X;m=++X)_=g[m],E[m]=(E[m]||0)+_*u;for(y=P=0,I=E.length;I>P;y=++P)_=E[y],E[y]=255&_;return E},n.prototype._scale=function(t,n,e){var i,r,l,a,s,o,u,h,c;if(1===n&&1===e)return t.slice();for(s=this.canvas.width,r=this.canvas.height,i=[],l=0,u=h=0;r>h;u=h+=1)for(o=c=0;s>c;o=c+=1)a=s*(u/e>>0)+(o/n>>0)<<2,i[l++]=t[a++],i[l++]=t[a++],i[l++]=t[a++],i[l++]=t[a++];return i},n.prototype._updatePixels=function(t){var n,e,i,r,l,a;for(n=(i=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)).data,e=l=0,a=t.length;a>l;e=++l)r=t[e],n[e]=r;return this.ctx.putImageData(i,0,0)},n}(),t.tm.KernelFilter=function(n){function e(t,n,e){this.radiusX=t,this.radiusY=n,this.kernel=e}var i;return r(e,n),i=t.Rectangle,e.prototype.getBounds=function(){return new i(-(this.radiusX-1),-(this.radiusY-1),2*this.radiusX-1,2*this.radiusY-1)},e.prototype.applyFilter=function(t,n,e,i,r,l,a,s){var o,u,h,c;return null==l&&(l=t),null==a&&(a=n),null==s&&(s=e),o=t.getImageData(n,e,i,r),u=o.data,h=l.createImageData(i,r),c=h.data,this.filter(i,r,u,c),l.putImageData(h,a,s),!0},e.prototype.filter=function(t,n,e,i){var r,l,a,s,o,u,h,c,p,f,d,y,m,w,N,v,_,g,E,x,A;for(null==i&&(i=[]),s=this.kernel,m=this.radiusX-1,w=this.radiusY-1,u=m+this.radiusX,o=w+this.radiusY,a=g=0,A=t*n;A>g;a=g+=1){for(v=a%t,_=a/t>>0,y=l=r=0,h=E=0;u>E;h=E+=1)for(c=x=0;o>x;c=x+=1)N=s[u*c+h],f=v-m+c,f=0>f?0:f>t-1?t-1:f,d=_-w+h,d=0>d?0:d>n-1?n-1:d,p=t*d+f<<2,y+=e[p++]*N,l+=e[p++]*N,r+=e[p]*N;p=t*_+v<<2,i[p++]=255&y,i[p++]=255&l,i[p++]=255&r,i[p]=e[p]}return i},e.prototype.clone=function(){return new e(this.radiusX,this.radiusY,this.kernel)},e.prototype.toString=function(){return"[KernelFilter]"},e}(t.Filter),t.tm.GaussianFilter=function(t){function n(t,e,i){var r,l,a,s,o,u,h,c,p,f,d,y,m;for(null==t&&(t=2),null==e&&(e=2),null==i&&(i=1),o=2*i*i,h=0,s=[],l=c=y=1-e;e>c;l=c+=1)for(r=p=m=1-t;t>p;r=p+=1)u=1/(o*Math.PI)*Math.exp(-(r*r+l*l)/o),h+=u,s.push(u);for(a=f=0,d=s.length;d>f;a=++f)s[a],s[a]/=h;n.__super__.constructor.call(this,t,e,s)}return r(n,t),n.prototype.clone=function(){var t;return t=new GaussianBlurFilter,t.kernel=this.kernel},n.prototype.toString=function(){return"[GaussianBlurFilter]"},n}(t.tm.KernelFilter),t.tm.Xor128=function(){function t(t){this.w=null!=t?t:88675123,this.x=123456789,this.y=362436069,this.z=521288629,this.w&=4294967295,this.cache=[]}return t.prototype.at=function(t){for(;t>=this.cache.length;)this.random();return this.cache[t]},t.prototype.random=function(){var t;return t=this.x^this.x<<11,this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.w^this.w>>19^(t^t>>8),this.cache.push(this.w),this.w},t}()}).call(this);