(function(){var t,n,e,r={}.hasOwnProperty,i=function(t,n){function e(){this.constructor=t}for(var i in n)r.call(n,i)&&(t[i]=n[i]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};n=function(t,e){var r,i,o;o=[];for(r in e)i=e[r],Object.prototype.hasOwnProperty.call(e,r)&&("[object Object]"===Object.prototype.toString.call(i)?(t[r]={},o.push(n(t[r],i))):o.push(t[r]=i));return o},"undefined"!=typeof window&&null!==window&&(null==window.createjs&&(window.createjs={}),t=window.createjs),null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)&&(null==(e=module.exports).createjs&&(e.createjs={}),t=module.exports.createjs),n(t,{tm:{}}),t.tm.Bitmap=function(n){function e(n){return n instanceof t.tm.BitmapData?this.initialize(n.canvas):(this.initialize(n),void 0)}return i(e,n),e}(t.Bitmap),t.tm.BitmapData=function(){function n(t,n){this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=n,this.ctx=this.canvas.getContext("2d")}var e,r,i,o;return i=t.Stage,e=t.Container,r=t.Shape,o=function(t){return"[object Number]"===Object.prototype.toString.call(t)},n.prototype.noise=function(t,n,e,r,i,o,l,s,a,u){return null==o&&(o=0),null==l&&(l=255),null==s&&(s=7),null==a&&(a=!1),null==u&&(u={x:0,y:0}),this._updatePixels(t,n,e,r,this._noise(e,r,i,o,l,s,a,u)),this},n.prototype._noise=function(n,e,r,i,o,l,s,a){var u,h,c,p,f,d,m,y,w,g,v,x,_,j,F,b,X,B;if(null==i&&(i=0),null==o&&(o=255),null==l&&(l=7),null==s&&(s=!1),B=null!=a?a:{x:0,y:0},v=B.x,_=B.y,m=Math.min(i,o),y=Math.abs(i-o),x=new t.tm.Xor128(r%255<<24|v%4095<<12|_%4095),w=[],d=0,s)for(p=j=0;e>j;p=j+=1)for(c=F=0;n>F;c=F+=1)g=f=h=m+x.random()%y,u=255,w[d++]=g,w[d++]=f,w[d++]=h,w[d++]=u;else for(c=b=0;n>b;c=b+=1)for(p=X=0;e>X;p=X+=1)g=m+x.random()%y,f=m+x.random()%y,h=m+x.random()%y,u=255,w[d++]=g,w[d++]=f,w[d++]=h,w[d++]=u;return w},n.prototype.perlinNoise=function(t,n,e,r,i,o,l,s,a,u,h,c,p){return null==h&&(h=7),null==c&&(c=!1),null==p&&(p=[]),this._updatePixels(t,n,e,r,this._perlinNoise(e,r,i,o,l,s,a,u,h,c,p)),this},n.prototype._perlinNoise=function(n,e,r,i,o,l,s,a,u,h,c){var p,f,d,m,y,w,g,v,x,_,j,F,b,X,B,D,I,M,O,P,S,Y,k,z,G,N,K,C;for(null==u&&(u=7),null==h&&(h=!1),null==c&&(c=[]),w=[],x=[],X=0,f=I=0;o>I;f=I+=1)D=1<<f,x[f]=D,X+=D;for(m=1/X,f=M=0,S=x.length;S>M;f=++M)v=x[f],x[f]*=m;for(f=O=0;o>O;f=O+=1)g=c[f],F=1<<f,B=Math.ceil(n/F),p=Math.ceil(e/F),j=this._noise(B,p,l,0,255,u,h,g),j=this._scale(j,B,p,n,e,f),0!==f&&(j=new t.tm.GaussianFilter(1<<f,1<<f,f).filter(n,e,j)),w[f]=y={persistence:x[f],pixels:j};for(b=[],f=P=0,Y=x.length;Y>P;f=++P)if(v=x[f],j=w[f].pixels,0===f)for(d=N=0,k=j.length;k>N;d=++N)_=j[d],b[d]=_*v;else for(d=K=0,z=j.length;z>K;d=++K)_=j[d],b[d]+=_*v;for(f=C=0,G=b.length;G>C;f=++C)_=b[f],b[f]=255&_;return b},n.prototype._scale=function(t,n,e,r,i,o){var l,s,a,u,h,c,p;if(0===o)return t.slice();for(l=[],s=0,h=c=0;i>=0?i>c:c>i;h=i>=0?++c:--c)for(u=p=0;r>=0?r>p:p>r;u=r>=0?++p:--p)a=n*(h>>o)+(u>>o)<<2,l[s++]=t[a++],l[s++]=t[a++],l[s++]=t[a++],l[s++]=t[a++];return l},n.prototype._updatePixels=function(t,n,e,r,i){var o,l,s,a,u,h;for(o=(s=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)).data,l=u=0,h=i.length;h>u;l=++u)a=i[l],o[l]=a;return this.ctx.putImageData(s,0,0)},n}(),t.tm.KernelFilter=function(n){function e(t,n,e){this.radiusX=t,this.radiusY=n,this.kernel=e}var r;return i(e,n),r=t.Rectangle,e.prototype.getBounds=function(){return new r(-(this.radiusX-1),-(this.radiusY-1),2*this.radiusX-1,2*this.radiusY-1)},e.prototype.applyFilter=function(t,n,e,r,i,o,l,s){var a,u,h,c;return null==o&&(o=t),null==l&&(l=n),null==s&&(s=e),a=t.getImageData(n,e,r,i),u=a.data,h=o.createImageData(r,i),c=h.data,this.filter(r,i,u,c),o.putImageData(h,l,s),!0},e.prototype.filter=function(t,n,e,r){var i,o,l,s,a,u,h,c,p,f,d,m,y,w,g,v,x,_,j,F;for(null==r&&(r=[]),l=this.kernel,m=this.radiusX-1,y=this.radiusY-1,a=m+this.radiusX,s=y+this.radiusY,v=x=0;n>x;v=x+=1)for(g=_=0;t>_;g=_+=1){for(d=o=i=0,u=j=0;a>j;u=j+=1)for(h=F=0;s>F;h=F+=1)w=l[a*h+u],p=g-m+h,p=0>p?0:p>t-1?t-1:p,f=v-y+u,f=0>f?0:f>n-1?n-1:f,c=t*f+p<<2,d+=e[c]*w,o+=e[++c]*w,i+=e[++c]*w;c=t*v+g<<2,r[c]=255&d,r[++c]=255&o,r[++c]=255&i,r[++c]=e[c]}return r},e.prototype.clone=function(){return new e(this.radiusX,this.radiusY,this.kernel)},e.prototype.toString=function(){return"[KernelFilter]"},e}(t.Filter),t.tm.GaussianFilter=function(t){function n(t,e,r){var i,o,l,s,a,u,h,c,p,f,d,m,y;for(null==r&&(r=1),a=2*r*r,h=0,s=[],o=c=m=1-e;e>c;o=c+=1)for(i=p=y=1-t;t>p;i=p+=1)u=1/(a*Math.PI)*Math.exp(-(i*i+o*o)/a),h+=u,s.push(u);for(l=f=0,d=s.length;d>f;l=++f)s[l],s[l]/=h;n.__super__.constructor.call(this,t,e,s)}return i(n,t),n.prototype.clone=function(){var t;return t=new GaussianBlurFilter,t.kernel=this.kernel},n.prototype.toString=function(){return"[GaussianBlurFilter]"},n}(t.tm.KernelFilter),t.tm.Xor128=function(){function t(t){null==t&&(t=88675123),this.x=123456789,this.y=362436069,this.z=521288629,this.w=t%4294967295}return t.prototype.random=function(){var t;return t=this.x^this.x<<11,this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.w^this.w>>19^(t^t>>8)},t}()}).call(this);